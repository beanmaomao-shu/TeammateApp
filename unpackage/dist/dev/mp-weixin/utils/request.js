"use strict";const o=require("../common/vendor.js"),i="http://117.72.54.182:8898",c=t=>new Promise((d,n)=>{const a=o.index.getStorageSync("token");let s=t.data;t.method==="POST"&&t.data&&(s={...t.data}),o.index.request({...t,url:i+t.url,data:s,header:{"Content-Type":"application/json",...t.header,...a?{Authorization:a}:{}},success:e=>{console.log("请求响应：",e),e.statusCode===200?d(e.data):e.statusCode===401?(o.index.removeStorageSync("token"),o.index.showToast({title:"请重新登录",icon:"none"}),n(e)):(o.index.showToast({title:`请求失败: ${e.statusCode}`,icon:"none"}),console.error("请求失败详情：",e),n(e))},fail:e=>{console.error("网络错误详情：",e),o.index.showToast({title:"网络错误",icon:"none"}),n(e)}})});exports.request=c;
