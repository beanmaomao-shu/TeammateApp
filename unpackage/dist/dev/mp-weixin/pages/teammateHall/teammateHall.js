"use strict";const e=require("../../common/vendor.js"),a=require("../../common/assets.js"),F=require("../../api/contest.js"),T=require("../../api/search.js"),U=require("../../api/login.js");if(!Array){const p=e.resolveComponent("van-notice-bar"),c=e.resolveComponent("dash");(p+c)()}const E=()=>"../../components/dash/dash.js";Math||E();const D={__name:"teammateHall",props:{toValue:{type:String}},setup(p){e.useRouter();const c=e.ref(!1),i=e.ref(""),n=e.ref(!1),l=e.ref([]);e.ref([]);const m=e.ref([]);let h=null;const _=e.ref(!1),v=()=>{setInterval(()=>{c.value=!0},1e3)},f=async()=>{try{e.index.getStorageSync("token")||await g();const r=await F.getContest();m.value=r.data,console.log(r.data)}catch(o){console.error("获取比赛列表失败：",o),e.index.showToast({title:"获取比赛信息失败",icon:"none"})}},$=async()=>{if(clearTimeout(h),!i.value){l.value=[],n.value=!1;return}h=setTimeout(async()=>{try{const o=await T.searchContest(i.value);o.data&&(l.value=o.data,console.log(o.data),n.value=!0)}catch(o){console.error("搜索失败：",o),e.index.showToast({title:"搜索失败",icon:"none"})}},300)},x=o=>{i.value=o.name,n.value=!1,d()},C=()=>{setTimeout(()=>{n.value=!1},200)},d=()=>{if(!i.value){e.index.showToast({title:"请输入搜索内容",icon:"none"});return}e.index.navigateTo({url:`/pages/searchDetail/searchDetail?value=${encodeURIComponent(i.value)}`})};e.ref([{id:1,matchName:"2024年第十四届APMCM亚太地区大学生数学建模竞赛",name:"听党的就队",imgUrl:"../../static/images/match6.png"},{id:2,matchName:"2024年全国大学生英语翻译大赛（NETCCS）",name:"六级能不能过队",imgUrl:"../../static/images/match3.png"},{id:3,matchName:'2024年第五届"中译国青杯"国际组织文件翻译大赛',name:"超级翻译官队",imgUrl:"../../static/images/match4.png"},{id:4,matchName:"2024创想中国全国大学生创新创业大赛",name:"小呆呆创新队",imgUrl:"../../static/images/match15.png"},{id:5,matchName:'第三届"中外传播杯"全国大学生英语翻译大赛-英译汉赛道',name:"翻译的都队",imgUrl:"../../static/images/match8.png"},{id:6,matchName:'第二届"数学周报"全国大学生数学能力大赛',name:"基本不懂式队",imgUrl:"../../static/images/match13.png"},{id:7,matchName:"2024第二届全国大学生数学竞赛暨创新思维挑战赛",name:"哎我队",imgUrl:"../../static/images/match11.png"},{id:8,matchName:"CCF2024年中国计算机应用技术大赛-全国算法精英大赛",name:"AC队",imgUrl:"../../static/images/match7.png"},{id:9,matchName:"浙大研究院《智能无人机》研学实践项目",name:"让你飞起来队",imgUrl:"../../static/images/match14.png"}]);const g=async()=>{try{const o=await e.index.login();if(o.code){console.log("获取code成功：",o.code);const r=await U.login(o.code);if(console.log("登录响应：",r),r.data&&r.data.token)return _.value=!0,e.index.setStorageSync("token",r.data.token),console.log(r.data.token),r.data.openid&&e.index.setStorageSync("openid",r.data.openid),e.index.showToast({title:"登录成功",icon:"success"}),r.data.token;throw new Error("登录失败：未获取到token")}}catch(o){throw console.error("登录失败：",o),e.index.showToast({title:"登录失败，请重试",icon:"none"}),o}},w=()=>{g()},y=e.ref(""),b=p;return f(),e.onLoad(()=>{y.value=b.toValue}),e.onMounted(async()=>{try{await g(),await f()}catch(o){console.error("初始化失败：",o)}}),(o,r)=>e.e({a:e.o([t=>i.value=t.detail.value,$]),b:e.o(t=>n.value=!0),c:e.o(C),d:i.value,e:a._imports_0$1,f:e.o(d),g:n.value&&l.value.length},n.value&&l.value.length?{h:e.f(l.value,(t,s,u)=>({a:e.t(t.name),b:s,c:e.o(k=>x(t),s)}))}:{},{i:e.p({scrollable:!0,color:"#AC33C1",background:"#F1E6FF"}),j:e.f(m.value,(t,s,u)=>({a:t.poster,b:s})),k:e.p({Color:"#E5E5E5",Width:"780rpx",Height:"10rpx"}),l:a._imports_1$3,m:a._imports_2$2,n:e.p({Color:"#F1E6FF",Width:"700rpx",Height:"8rpx"}),o:c.value},c.value?{p:a._imports_3$1,q:a._imports_0,r:a._imports_1$2,s:a._imports_5,t:"/pages/teamDetail/teamDetail?tocPageValue=c"}:{},{v:a._imports_7,w:a._imports_0,x:a._imports_1,y:a._imports_2,z:a._imports_3,A:a._imports_5,B:e.f(m.value,(t,s,u)=>({a:t.poster,b:e.t(t.name),c:`/pages/teamDetail/teamDetail?id=${t.id}&toaPageValue=a`,d:t.id})),C:a._imports_0,D:a._imports_1$1,E:a._imports_2$1,F:a._imports_1$2,G:a._imports_1$2,H:a._imports_4,I:a._imports_5,J:!_.value},_.value?{}:{K:e.o(w)},{L:e.o(v),M:e.o([t=>i.value=t.detail.value,$]),N:e.o(t=>n.value=!0),O:e.o(C),P:i.value,Q:a._imports_0$1,R:e.o(d),S:n.value&&l.value.length},n.value&&l.value.length?{T:e.f(l.value,(t,s,u)=>({a:e.t(t.name),b:s,c:e.o(k=>x(t),s)}))}:{},{U:e.p({scrollable:!0,color:"#AC33C1",background:"#F1E6FF"}),V:e.f(m.value,(t,s,u)=>({a:t.poster,b:s})),W:e.p({Color:"#E5E5E5",Width:"780rpx",Height:"10rpx"}),X:a._imports_1$3,Y:a._imports_2$2,Z:e.p({Color:"#F1E6FF",Width:"700rpx",Height:"8rpx"}),aa:c.value},c.value?{ab:a._imports_3$1,ac:a._imports_0,ad:a._imports_1$2,ae:a._imports_5,af:"/pages/teamDetail/teamDetail?tocPageValue=c"}:{},{ag:a._imports_7,ah:a._imports_0,ai:a._imports_1,aj:a._imports_2,ak:a._imports_3,al:a._imports_5,am:e.f(m.value,(t,s,u)=>({a:t.poster,b:e.t(t.name),c:`/pages/teamDetail/teamDetail?id=${t.id}&toaPageValue=a`,d:t.id})),an:a._imports_0,ao:a._imports_1$1,ap:a._imports_2$1,aq:a._imports_1$2,ar:a._imports_1$2,as:a._imports_4,at:a._imports_5,av:!_.value},_.value?{}:{aw:e.o((...t)=>o.handleGetUserInfo&&o.handleGetUserInfo(...t))},{ax:e.o(v)})}},S=e._export_sfc(D,[["__scopeId","data-v-305e4dd3"]]);wx.createPage(S);
